{% extends 'revenue_app/base.html' %}
{% load static %}

{% block content %}
<h1 class="text-center">Top 10 Argentina Organizers</h1>
<br>
<div class="row">
	<div class="col-6">
		<table class="table table-hover">
			<thead>
				<tr>
					<th scope="col">Email</th>
					<th scope="col">sale__payment_amount__epp</th>
				</tr>
			</thead>
			<tbody>
				{% for index, transactions in top_ars.iterrows %}
				<tr>
					<td><a href="{% url 'organizer-transactions' organizer_id=transactions.eventholder_user_id %}">{{transactions.email}}</a></td>
					<td>{{transactions.sale__payment_amount__epp}}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	<div class="col-6 chart-container">
		<canvas id="chart_arg"></canvas>
	</div>
</div>
<br>
<hr class="mb-4 mt-4">
<br>
<h1 class="text-center">Top 10 Brazil Organizers</h1>
<br>
<div class="row">
	<div class="col-6 chart-container">
		<canvas id="chart_brl"></canvas>
	</div>
	<div class="col-6">
		<table class="table table-hover">
			<thead>
				<tr>
					<th scope="col">Email</th>
					<th scope="col">sale__payment_amount__epp</th>
				</tr>
			</thead>
			<tbody>
				{% for index, transactions in top_brl.iterrows %}
				<tr>
					<td><a href="{% url 'organizer-transactions' organizer_id=transactions.eventholder_user_id %}">{{transactions.email}}</a></td>
					<td>{{transactions.sale__payment_amount__epp}}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</div>
{% endblock content %}

{% block scripts %}
{{ block.super }}
<script type="text/javascript" src="{% static 'js/Chart.min.js' %}"></script>
<script type="text/javascript">
  $.get('{% url "json_top_organizers" %}', function(data) {
	var ctx_ars = $("#chart_arg").get(0).getContext("2d");
	new Chart(ctx_ars, {
	  type: 'doughnut',
	  data: {
		  labels: data.arg.labels,
		  datasets: [{
			  label: "Top Argentina Organizers",
			  data: data.arg.data,
			  fill: false,
			  backgroundColor: data.arg.backgroundColor,
			  borderColor: data.arg.borderColor,
			  borderWidth: 1,
		  }]
	  },
	  options: {
		  legend: { position: 'bottom' },
		  responsive: true,
		  maintainAspectRatio: false,
	  },
	});

	var ctx_brl = $("#chart_brl").get(0).getContext("2d");
	new Chart(ctx_brl, {
	  type: 'doughnut',
	  data: {
		  labels: data.brl.labels,
		  datasets: [{
			  label: "Top Brazil Organizers",
			  data: data.brl.data,
			  fill: false,
			  backgroundColor: data.brl.backgroundColor,
			  borderColor: data.brl.borderColor,
			  borderWidth: 1,
		  }]
	  },
	  options: {
		  legend: { position: 'bottom' },
		  responsive: true,
		  maintainAspectRatio: false,
	  },
  	});
  });
</script>
{% endblock scripts %}
